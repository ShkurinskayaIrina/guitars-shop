{"ast":null,"code":"import { createAsyncThunk } from '@reduxjs/toolkit';\nimport { errorHandle } from '../services/error-handle';\nimport { getSortByPrice } from '../utils/utils';\nimport { loadCatalog, loadGuitar, loadComments, loadCatalogPriceRange } from './guitars-data/guitars-data';\nimport { APIRoute } from '../consts';\nexport const fetchCatalogGuitars = createAsyncThunk('guitars/fetchCatalogGuitars', async (_arg, _ref) => {\n  let {\n    dispatch,\n    extra: api\n  } = _ref;\n\n  try {\n    const {\n      data\n    } = await api.get(APIRoute.Guitars);\n    const catalogSortingByPrice = data.sort(getSortByPrice);\n    const priceMin = catalogSortingByPrice[0].price;\n    const priceMax = catalogSortingByPrice[catalogSortingByPrice.length - 1].price;\n    dispatch(loadCatalog(data));\n    dispatch(loadCatalogPriceRange({\n      priceMin,\n      priceMax\n    }));\n  } catch (error) {\n    errorHandle(error);\n  }\n});\nexport const fetchGuitar = createAsyncThunk('guitars/fetchGuitar', async (id, _ref2) => {\n  let {\n    dispatch,\n    extra: api\n  } = _ref2;\n\n  try {\n    const {\n      data\n    } = await api.get(`${APIRoute.Guitars}/${id}`);\n    dispatch(loadGuitar(data));\n  } catch (error) {\n    errorHandle(error);\n  }\n});\nexport const fetchComments = createAsyncThunk('guitar/fetchComments', async (id, _ref3) => {\n  let {\n    dispatch,\n    extra: api\n  } = _ref3;\n\n  try {\n    const {\n      data\n    } = await api.get(`${APIRoute.Guitars}/${id}/comments`);\n    dispatch(loadComments({\n      id,\n      data\n    }));\n  } catch (error) {\n    errorHandle(error);\n  }\n});\nexport const addCommentAction = createAsyncThunk('guitar/addCommentAction', async (comment, _ref4) => {\n  let {\n    dispatch,\n    extra: api\n  } = _ref4;\n\n  try {\n    await api.post(APIRoute.Comments, comment);\n    dispatch(fetchComments(Number(comment.guitarId)));\n  } catch (error) {\n    errorHandle(error);\n  }\n});","map":{"version":3,"names":["createAsyncThunk","errorHandle","getSortByPrice","loadCatalog","loadGuitar","loadComments","loadCatalogPriceRange","APIRoute","fetchCatalogGuitars","_arg","dispatch","extra","api","data","get","Guitars","catalogSortingByPrice","sort","priceMin","price","priceMax","length","error","fetchGuitar","id","fetchComments","addCommentAction","comment","post","Comments","Number","guitarId"],"sources":["C:/Ирина/Projects/guitars-shop/src/store/api-actions.ts"],"sourcesContent":["import {AxiosInstance} from 'axios';\r\nimport { createAsyncThunk } from '@reduxjs/toolkit';\r\nimport { AppDispatch, State } from '../types/state';\r\nimport { errorHandle } from '../services/error-handle';\r\nimport { getSortByPrice } from '../utils/utils';\r\nimport { loadCatalog, loadGuitar, loadComments, loadCatalogPriceRange } from './guitars-data/guitars-data';\r\n\r\nimport { Guitar, Guitars, NewComment, Comments } from '../types/guitars';\r\nimport { APIRoute } from '../consts';\r\n\r\nexport const fetchCatalogGuitars = createAsyncThunk<void, undefined, {\r\n  dispatch: AppDispatch,\r\n  state: State,\r\n  extra: AxiosInstance\r\n}>(\r\n  'guitars/fetchCatalogGuitars',\r\n  async(_arg, {dispatch, extra: api})=>{\r\n    try {\r\n      const { data } = await api.get<Guitars>(APIRoute.Guitars);\r\n      const catalogSortingByPrice = data.sort(getSortByPrice);\r\n      const priceMin = catalogSortingByPrice[0].price;\r\n      const priceMax = catalogSortingByPrice[catalogSortingByPrice.length-1].price;\r\n      dispatch(loadCatalog(data));\r\n      dispatch(loadCatalogPriceRange({priceMin, priceMax}));\r\n    } catch (error) {\r\n      errorHandle(error);\r\n    }\r\n  },\r\n);\r\n\r\nexport const fetchGuitar = createAsyncThunk<void, number, {\r\n  dispatch: AppDispatch,\r\n  state: State,\r\n  extra: AxiosInstance\r\n}>(\r\n  'guitars/fetchGuitar',\r\n  async (id, {dispatch, extra: api}) => {\r\n    try {\r\n      const {data} = await api.get<Guitar>(`${APIRoute.Guitars}/${id}`);\r\n      dispatch(loadGuitar(data));\r\n    } catch (error) {\r\n      errorHandle(error);\r\n    }\r\n  },\r\n);\r\n\r\nexport const fetchComments = createAsyncThunk<void, number, {\r\n  dispatch: AppDispatch,\r\n  state: State,\r\n  extra: AxiosInstance\r\n}>(\r\n  'guitar/fetchComments',\r\n  async (id, {dispatch, extra: api}) => {\r\n    try {\r\n      const {data} = await api.get<Comments>(`${APIRoute.Guitars}/${id}/comments`);\r\n      dispatch(loadComments({id, data}));\r\n    } catch (error) {\r\n      errorHandle(error);\r\n    }\r\n  },\r\n);\r\n\r\nexport const addCommentAction  = createAsyncThunk<void, NewComment, {\r\n  dispatch: AppDispatch,\r\n  state: State,\r\n  extra: AxiosInstance\r\n}>(\r\n  'guitar/addCommentAction',\r\n  async (comment, {dispatch, extra: api}) => {\r\n    try {\r\n      await api.post<Comments>(APIRoute.Comments, comment);\r\n      dispatch(fetchComments(Number(comment.guitarId)));\r\n    } catch (error) {\r\n      errorHandle(error);\r\n    }\r\n  },\r\n);\r\n\r\n\r\n"],"mappings":"AACA,SAASA,gBAAT,QAAiC,kBAAjC;AAEA,SAASC,WAAT,QAA4B,0BAA5B;AACA,SAASC,cAAT,QAA+B,gBAA/B;AACA,SAASC,WAAT,EAAsBC,UAAtB,EAAkCC,YAAlC,EAAgDC,qBAAhD,QAA6E,6BAA7E;AAGA,SAASC,QAAT,QAAyB,WAAzB;AAEA,OAAO,MAAMC,mBAAmB,GAAGR,gBAAgB,CAKjD,6BALiD,EAMjD,OAAMS,IAAN,WAAqC;EAAA,IAAzB;IAACC,QAAD;IAAWC,KAAK,EAAEC;EAAlB,CAAyB;;EACnC,IAAI;IACF,MAAM;MAAEC;IAAF,IAAW,MAAMD,GAAG,CAACE,GAAJ,CAAiBP,QAAQ,CAACQ,OAA1B,CAAvB;IACA,MAAMC,qBAAqB,GAAGH,IAAI,CAACI,IAAL,CAAUf,cAAV,CAA9B;IACA,MAAMgB,QAAQ,GAAGF,qBAAqB,CAAC,CAAD,CAArB,CAAyBG,KAA1C;IACA,MAAMC,QAAQ,GAAGJ,qBAAqB,CAACA,qBAAqB,CAACK,MAAtB,GAA6B,CAA9B,CAArB,CAAsDF,KAAvE;IACAT,QAAQ,CAACP,WAAW,CAACU,IAAD,CAAZ,CAAR;IACAH,QAAQ,CAACJ,qBAAqB,CAAC;MAACY,QAAD;MAAWE;IAAX,CAAD,CAAtB,CAAR;EACD,CAPD,CAOE,OAAOE,KAAP,EAAc;IACdrB,WAAW,CAACqB,KAAD,CAAX;EACD;AACF,CAjBgD,CAA5C;AAoBP,OAAO,MAAMC,WAAW,GAAGvB,gBAAgB,CAKzC,qBALyC,EAMzC,OAAOwB,EAAP,YAAsC;EAAA,IAA3B;IAACd,QAAD;IAAWC,KAAK,EAAEC;EAAlB,CAA2B;;EACpC,IAAI;IACF,MAAM;MAACC;IAAD,IAAS,MAAMD,GAAG,CAACE,GAAJ,CAAiB,GAAEP,QAAQ,CAACQ,OAAQ,IAAGS,EAAG,EAA1C,CAArB;IACAd,QAAQ,CAACN,UAAU,CAACS,IAAD,CAAX,CAAR;EACD,CAHD,CAGE,OAAOS,KAAP,EAAc;IACdrB,WAAW,CAACqB,KAAD,CAAX;EACD;AACF,CAbwC,CAApC;AAgBP,OAAO,MAAMG,aAAa,GAAGzB,gBAAgB,CAK3C,sBAL2C,EAM3C,OAAOwB,EAAP,YAAsC;EAAA,IAA3B;IAACd,QAAD;IAAWC,KAAK,EAAEC;EAAlB,CAA2B;;EACpC,IAAI;IACF,MAAM;MAACC;IAAD,IAAS,MAAMD,GAAG,CAACE,GAAJ,CAAmB,GAAEP,QAAQ,CAACQ,OAAQ,IAAGS,EAAG,WAA5C,CAArB;IACAd,QAAQ,CAACL,YAAY,CAAC;MAACmB,EAAD;MAAKX;IAAL,CAAD,CAAb,CAAR;EACD,CAHD,CAGE,OAAOS,KAAP,EAAc;IACdrB,WAAW,CAACqB,KAAD,CAAX;EACD;AACF,CAb0C,CAAtC;AAgBP,OAAO,MAAMI,gBAAgB,GAAI1B,gBAAgB,CAK/C,yBAL+C,EAM/C,OAAO2B,OAAP,YAA2C;EAAA,IAA3B;IAACjB,QAAD;IAAWC,KAAK,EAAEC;EAAlB,CAA2B;;EACzC,IAAI;IACF,MAAMA,GAAG,CAACgB,IAAJ,CAAmBrB,QAAQ,CAACsB,QAA5B,EAAsCF,OAAtC,CAAN;IACAjB,QAAQ,CAACe,aAAa,CAACK,MAAM,CAACH,OAAO,CAACI,QAAT,CAAP,CAAd,CAAR;EACD,CAHD,CAGE,OAAOT,KAAP,EAAc;IACdrB,WAAW,CAACqB,KAAD,CAAX;EACD;AACF,CAb8C,CAA1C"},"metadata":{},"sourceType":"module"}