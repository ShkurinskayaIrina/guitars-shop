{"ast":null,"code":"import _toConsumableArray from\"C:/\\u0418\\u0440\\u0438\\u043D\\u0430/Projects/guitars-shop/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/\\u0418\\u0440\\u0438\\u043D\\u0430/Projects/guitars-shop/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Fragment,useEffect,useState}from'react';import{fetchCountComments}from'../../store/api';import{STAR_COUNT,ratingRange}from'../../consts';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function RatingBlock(_ref){var id=_ref.id,rating=_ref.rating,width=_ref.width,height=_ref.height,isReview=_ref.isReview;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),commentsCount=_useState2[0],setCommentsCount=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),fetching=_useState4[0],setFetching=_useState4[1];useEffect(function(){if(!isReview){if(fetching){fetchCountComments(id).then(function(data){setCommentsCount(data);}).finally(function(){setFetching(false);});}}},[id,fetching,isReview]);return/*#__PURE__*/_jsxs(_Fragment,{children:[_toConsumableArray(Array(STAR_COUNT)).map(function(_,index){var keyValue=index;return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"svg\",{width:width,height:height,\"aria-hidden\":\"true\",\"data-testid\":\"star\",children:/*#__PURE__*/_jsx(\"use\",{xlinkHref:Math.floor(rating)>index?'#icon-full-star':'#icon-star'})})},keyValue);}),/*#__PURE__*/_jsxs(\"p\",{className:\"visually-hidden\",children:[\"\\u041E\\u0446\\u0435\\u043D\\u043A\\u0430: \",ratingRange[Math.floor(rating)-1]]}),/*#__PURE__*/_jsx(\"p\",{className:\"rate__count\",children:isReview===false?/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"\\u0412\\u0441\\u0435\\u0433\\u043E \\u043E\\u0446\\u0435\\u043D\\u043E\\u043A:\"}),\" \",commentsCount]}):''})]});}export default RatingBlock;","map":{"version":3,"names":["Fragment","useEffect","useState","fetchCountComments","STAR_COUNT","ratingRange","RatingBlock","id","rating","width","height","isReview","commentsCount","setCommentsCount","fetching","setFetching","then","data","finally","Array","map","_","index","keyValue","Math","floor"],"sources":["C:/Ирина/Projects/guitars-shop/src/components/rating-block/rating-block.tsx"],"sourcesContent":["import { Fragment, useEffect, useState } from 'react';\r\nimport { fetchCountComments } from '../../store/api';\r\nimport { STAR_COUNT, ratingRange } from '../../consts';\r\n\r\ntype Props = {\r\n  id: number,\r\n  width: string,\r\n  height: string,\r\n  rating: number,\r\n  isReview: boolean,\r\n}\r\n\r\nfunction RatingBlock({id, rating, width, height, isReview}: Props): JSX.Element {\r\n  const [commentsCount, setCommentsCount] = useState(0);\r\n  const [fetching, setFetching] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (!isReview) {\r\n      if (fetching) {\r\n        fetchCountComments(id)\r\n          .then((data: number) => {\r\n            setCommentsCount(data);\r\n          })\r\n          .finally(()=>{setFetching(false);});\r\n      }\r\n    }\r\n  }, [id, fetching, isReview]);\r\n\r\n  return (\r\n    <>\r\n      {[...Array(STAR_COUNT)].map((_,index) => {\r\n        const keyValue = index;\r\n        return (\r\n          <Fragment key={keyValue}>\r\n            <svg width={width} height={height} aria-hidden=\"true\"  data-testid=\"star\">\r\n              <use xlinkHref={Math.floor(rating)>index ? '#icon-full-star' : '#icon-star'}></use>\r\n            </svg>\r\n          </Fragment>\r\n        );\r\n      })}\r\n      <p className=\"visually-hidden\">Оценка: {ratingRange[Math.floor(rating)-1]}</p>\r\n      <p className=\"rate__count\">\r\n\r\n        {isReview===false ?\r\n          <Fragment>\r\n            <span className=\"visually-hidden\">Всего оценок:</span> {commentsCount}\r\n          </Fragment>\r\n          :''}\r\n      </p>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default RatingBlock;\r\n"],"mappings":"kSAAA,OAASA,QAAT,CAAmBC,SAAnB,CAA8BC,QAA9B,KAA8C,OAA9C,CACA,OAASC,kBAAT,KAAmC,iBAAnC,CACA,OAASC,UAAT,CAAqBC,WAArB,KAAwC,cAAxC,C,6IAUA,QAASC,YAAT,MAAgF,IAA1DC,GAA0D,MAA1DA,EAA0D,CAAtDC,MAAsD,MAAtDA,MAAsD,CAA9CC,KAA8C,MAA9CA,KAA8C,CAAvCC,MAAuC,MAAvCA,MAAuC,CAA/BC,QAA+B,MAA/BA,QAA+B,CAC9E,cAA0CT,QAAQ,CAAC,CAAD,CAAlD,wCAAOU,aAAP,eAAsBC,gBAAtB,eACA,eAAgCX,QAAQ,CAAC,IAAD,CAAxC,yCAAOY,QAAP,eAAiBC,WAAjB,eAEAd,SAAS,CAAC,UAAM,CACd,GAAI,CAACU,QAAL,CAAe,CACb,GAAIG,QAAJ,CAAc,CACZX,kBAAkB,CAACI,EAAD,CAAlB,CACGS,IADH,CACQ,SAACC,IAAD,CAAkB,CACtBJ,gBAAgB,CAACI,IAAD,CAAhB,CACD,CAHH,EAIGC,OAJH,CAIW,UAAI,CAACH,WAAW,CAAC,KAAD,CAAX,CAAoB,CAJpC,EAKD,CACF,CACF,CAVQ,CAUN,CAACR,EAAD,CAAKO,QAAL,CAAeH,QAAf,CAVM,CAAT,CAYA,mBACE,2BACG,mBAAIQ,KAAK,CAACf,UAAD,CAAT,EAAuBgB,GAAvB,CAA2B,SAACC,CAAD,CAAGC,KAAH,CAAa,CACvC,GAAMC,SAAQ,CAAGD,KAAjB,CACA,mBACE,KAAC,QAAD,wBACE,YAAK,KAAK,CAAEb,KAAZ,CAAmB,MAAM,CAAEC,MAA3B,CAAmC,cAAY,MAA/C,CAAuD,cAAY,MAAnE,uBACE,YAAK,SAAS,CAAEc,IAAI,CAACC,KAAL,CAAWjB,MAAX,EAAmBc,KAAnB,CAA2B,iBAA3B,CAA+C,YAA/D,EADF,EADF,EAAeC,QAAf,CADF,CAOD,CATA,CADH,cAWE,WAAG,SAAS,CAAC,iBAAb,oDAAwClB,WAAW,CAACmB,IAAI,CAACC,KAAL,CAAWjB,MAAX,EAAmB,CAApB,CAAnD,GAXF,cAYE,UAAG,SAAS,CAAC,aAAb,UAEGG,QAAQ,GAAG,KAAX,cACC,MAAC,QAAD,yBACE,aAAM,SAAS,CAAC,iBAAhB,kFADF,KAC0DC,aAD1D,GADD,CAIE,EANL,EAZF,GADF,CAuBD,CAED,cAAeN,YAAf"},"metadata":{},"sourceType":"module"}